(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[30],{"+tCj":function(e,t,a){"use strict";var l=a("g09b"),s=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("IzEo");var n=l(a("bx4M"));a("14J3");var r=l(a("BMrR"));a("qVdP");var i=l(a("jsC+"));a("Pwec");var p=l(a("CtXQ"));a("jCWc");var o,d,u=l(a("kPKH")),c=l(a("jHYr")),h=s(a("q1tI")),m=a("MuoO"),f=l(a("CGfD")),g=(o=(0,m.connect)(e=>{return(0,c.default)(e),{}}),o(d=class extends h.PureComponent{constructor(e){super(e)}render(){var e=this.props,t=e.stylePro,a=void 0===t?{marginBottom:"10px"}:t,l=e.Cols,s=e.overlay,o=()=>h.default.createElement("svg",{t:"1581212425061",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1314",width:"32",height:"32"},h.default.createElement("path",{d:"M512 192m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z","p-id":"1315",fill:"#999999"}),h.default.createElement("path",{d:"M512 512m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z","p-id":"1316",fill:"#999999"}),h.default.createElement("path",{d:"M512 832m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z","p-id":"1317",fill:"#999999"}));return h.default.createElement(n.default,{style:a,hoverable:!0,bodyStyle:{padding:0}},h.default.createElement(r.default,{type:"flex",align:"middle",className:f.default.pl24},h.default.createElement(u.default,{span:23},l||""),s&&h.default.createElement(u.default,{span:1,className:f.default.bor},h.default.createElement(i.default,{overlay:s,placement:"bottomLeft"},h.default.createElement(p.default,{component:o,style:{width:"100%"}})))))}})||d);t.default=g},"695H":function(e,t,a){"use strict";var l=a("g09b"),s=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("2qtc");var n=l(a("kLXV")),r=l(a("jehZ"));a("sRBo");var i=l(a("kaz8"));a("14J3");var p=l(a("BMrR"));a("jCWc");var o=l(a("kPKH"));a("+L6B");var d=l(a("2/Rp"));a("y8nQ");var u,c,h,m,f=l(a("Vl3Y")),g=a("MuoO"),k=s(a("q1tI")),v=l(a("e6Ls")),E=f.default.Item,A=(u=f.default.create(),c=(0,g.connect)(e=>{var t=e.user;return{currUser:t.currentUser}}),u(h=c((m=class extends k.PureComponent{constructor(e){super(e),this.onChangeCheckbox=(e=>{this.setState({tags:e})}),this.handleSubmit=(()=>{var e=this.props,t=e.onChangeCheckbox,a=e.onOk,l=e.form,s=e.seeTag;s&&a&&a(),l.validateFields((e,l)=>{e||(a&&a(l),t&&t(this.state.tags))})}),this.state={tags:[]}}render(){var e=this.props.form.getFieldDecorator,t=this.props,a=t.seeTag,l=t.onCancel,s=t.title,u=t.tagLists,c=t.checkedValues,h={labelCol:{xs:{span:0},sm:{span:0}},wrapperCol:{xs:{span:24},sm:{span:24}}};return k.default.createElement(n.default,{title:s,width:600,visible:!0,className:v.default.TelescopicModal,onOk:this.handleSubmit,onCancel:this.handleSubmit,footer:[k.default.createElement(d.default,{onClick:l}," \u53d6\u6d88 "),k.default.createElement(d.default,{type:"primary",onClick:this.handleSubmit},"\u786e\u5b9a")]},a?k.default.createElement(p.default,{style:{marginBottom:"20px"}},a.map(e=>{return k.default.createElement(o.default,{key:e,span:8},e)})):k.default.createElement(f.default,{onSubmit:this.handleSubmit,layout:"horizontal",hideRequiredMark:!0},k.default.createElement(E,(0,r.default)({},h,{label:""}),e("tag",{initialValue:c||[],rules:[{required:!1,message:"\u8bf7\u9009\u62e9\u6807\u7b7e"}]})(k.default.createElement(i.default.Group,{style:{width:"100%"},onChange:this.onChangeCheckbox},k.default.createElement(p.default,null,u&&u.map(e=>{var t=e.name,a=e.tag_id;return k.default.createElement(o.default,{key:a,span:8},k.default.createElement(i.default,{value:t},t))})))))))}},h=m))||h)||h);t.default=A},CGfD:function(e,t,a){e.exports={teamsTit:"teamsTit___mcpPv",lt:"lt___2fgud",teamMinTit:"teamMinTit___3ZfSP",teamContent:"teamContent___2EFFS",pl24:"pl24___2b0Dg",bor:"bor___Jhjxz",example:"example___37ZCe",btns:"btns___3N65Z"}},Qwvg:function(e,t,a){"use strict";var l=a("g09b"),s=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("fOrg");var n=l(a("+KLJ"));a("/xke");var r=l(a("TeRw"));a("+L6B");var i=l(a("2/Rp"));a("OaEy");var p=l(a("2fM7"));a("2qtc");var o,d,u,c=l(a("kLXV")),h=s(a("q1tI")),m=a("MuoO"),f=l(a("e6Ls")),g=l(a("+kNj")),k=c.default.confirm,v=p.default.Option,E=g.default.Description,A=(o=(0,m.connect)(e=>{var t=e.user;return{user:t.currentUser}}),o((u=class extends h.PureComponent{constructor(e){super(e),this.getDockerComposeAppShow=(()=>{var e=this.state.app_exporte_status;if(e&&e.docker_compose){var t=e.docker_compose;return h.default.createElement(g.default,{size:"large",title:"DockerComposeApp\u89c4\u8303(DockerCompose\u73af\u5883\u53ef\u7528)",style:{marginBottom:32}},h.default.createElement(E,{term:"\u5bfc\u51fa\u72b6\u6001"},this.getStatus(t)),this.getAction(t,"docker-compose"))}}),this.getRainbondAppShow=(()=>{var e=this.state.app_exporte_status;if(e&&e.rainbond_app){var t=e.rainbond_app;return h.default.createElement(g.default,{size:"large",title:"RainbondApp\u89c4\u8303(Rainbond\u5e73\u53f0\u53ef\u7528)",style:{marginBottom:32}},h.default.createElement(E,{term:"\u5bfc\u51fa\u72b6\u6001"},this.getStatus(t)),this.getAction(t,"rainbond-app"))}}),this.getAction=((e,t)=>{return e.is_export_before?"success"==e.status?h.default.createElement("div",null,h.default.createElement(i.default,{type:"primary",size:"small",onClick:()=>{this.download(e.file_path)}},"\u4e0b\u8f7d"),h.default.createElement(i.default,{style:{marginLeft:16},size:"small",onClick:()=>{this.handleRelease(t)}},"\u91cd\u65b0\u5bfc\u51fa")):"exporting"==e.status?h.default.createElement("div",null,h.default.createElement(i.default,{disabled:!0,type:"primary",size:"small",onClick:()=>{this.download(e.file_path)}},"\u4e0b\u8f7d"),h.default.createElement(i.default,{disabled:!0,style:{marginLeft:16},size:"small",onClick:()=>{this.handleExporter(t)}},"\u91cd\u65b0\u5bfc\u51fa")):"failed"==e.status?h.default.createElement("div",null,h.default.createElement(i.default,{disabled:!0,type:"primary",size:"small",onClick:()=>{this.download(e.file_path)}},"\u4e0b\u8f7d"),h.default.createElement(i.default,{style:{marginLeft:16},size:"small",onClick:()=>{this.handleExporter(t)}},"\u91cd\u65b0\u5bfc\u51fa")):void 0:h.default.createElement(i.default,{type:"primary",size:"small",onClick:()=>{this.handleRelease(t)}},"\u5bfc\u51fa")}),this.getStatus=(e=>{return e.is_export_before?"success"==e.status?"\u6210\u529f":"failed"==e.status?"\u5931\u8d25":"exporting"==e.status?"\u8fdb\u884c\u4e2d":void 0:"\b\u672a\u5bfc\u51fa"}),this.handleVersionInfo=(()=>{var e=this.state,t=e.exportVersionList,a=e.exportVersion;if(a&&a.length>0){var l=t.filter(e=>e.version===a[0]);l.length>0&&this.setState({versionInfo:l[0]})}}),this.handleRelease=(e=>{var t=this.state.versionInfo,a=this;""===t.dev_status?k({title:"\u5f53\u524d\u5bfc\u51fa\u7248\u672c\u975eRelease\u72b6\u6001",content:"\u662f\u5426\u7ee7\u7eed\u5bfc\u51fa",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk(){return a.handleExporter(e),new Promise((e,t)=>{setTimeout(Math.random()>.5?e:t,1e3)}).catch(()=>console.log("Oops errors!"))}}):a.handleExporter(e)}),this.handleCancel=(()=>{var e=this.props.onCancel;e&&e()}),this.handleExporter=(e=>{var t=this.props,a=t.app,l=t.eid,s=t.dispatch,n=this.state.exportVersion;s({type:"market/appExport",payload:{app_id:a.app_id,enterprise_id:l,app_versions:n,format:e},callback:e=>{e&&e.bean&&(r.default.success({message:"\u64cd\u4f5c\u6210\u529f\uff0c\u5f00\u59cb\u5bfc\u51fa\uff0c\u8bf7\u7a0d\u7b49\uff01"}),this.queryExport())}})}),this.queryExport=(()=>{var e=this.props,t=e.app,a=e.eid,l=e.dispatch,s=e.setIsExporting,n=this.state.exportVersion;n=n.join(),l({type:"market/queryExport",payload:{enterprise_id:a,body:{app_id:t.app_id,app_version:n}},callback:e=>{e&&((e.list&&e.list.length>0&&e.list[0].rainbond_app&&"exporting"==e.list[0].rainbond_app.status||e.list&&e.list.length>0&&e.list[0].docker_compose&&"exporting"==e.list[0].docker_compose.status)&&(s(!0),setTimeout(()=>{this.queryExport()},5e3)),(e.list&&e.list.length>0&&e.list[0].rainbond_app&&"exporting"!=e.list[0].rainbond_app.status||e.list&&e.list.length>0&&e.list[0].docker_compose&&"exporting"!=e.list[0].docker_compose.status)&&s(!1),this.setState({app_exporte_status:e.list&&e.list.length>0&&e.list[0]}))}})}),this.download=(e=>{var t=document.querySelector("#down-a-element");if(t||(t=document.createElement("a"),t.setAttribute("download","filename"),document.body.appendChild(t)),t.href=e,document.all)t.click();else{var a=document.createEvent("MouseEvents");a.initEvent("click",!0,!0),t.dispatchEvent(a)}}),this.handleChange=(e=>{this.setState({exportVersion:[e]},()=>{this.handleVersionInfo(),this.queryExport()})});var t=e.app,a=void 0===t?{}:t;this.state={app_exporte_status:null,exportVersionList:a.versions_info||[],versionInfo:{},exportVersion:a.versions_info&&a.versions_info.length>0&&[a.versions_info[a.versions_info.length-1].version]||""}}componentDidMount(){var e=this.state,t=e.exportVersionList,a=e.exportVersion;t&&t.length>0&&a&&this.handleVersionInfo(),this.queryExport()}render(){var e=this.props,t=e.onOk,a=e.onCancel,l=e.loading,s=this.state,r=s.exportVersion,o=s.exportVersionList;return h.default.createElement(c.default,{title:"\u5bfc\u51fa\u4e91\u5e02\u5e94\u7528",onOk:t,visible:!0,className:f.default.TelescopicModal,onCancel:a,footer:[h.default.createElement(i.default,{onClick:a}," \u53d6\u6d88 "),h.default.createElement(i.default,{type:"primary",loading:l||!1,onClick:t},"\u786e\u5b9a")]},h.default.createElement(n.default,{style:{textAlign:"center",marginBottom:16},message:"\u5bfc\u51fa\u4e91\u5e02\u5e94\u7528\u9002\u7528\u4e8e\u4ea4\u4ed8\u73af\u5883",type:"success"}),h.default.createElement("div",{style:{marginBottom:"30px"}},"\u5bfc\u51fa\u7248\u672c\uff1a",h.default.createElement(p.default,{defaultValue:r,onChange:this.handleChange,size:"small"},o.map(e=>{var t=e.version;return h.default.createElement(v,{key:"key:".concat(t),value:t},t)}))),this.getRainbondAppShow(),!("market"==this.props.app.source)&&this.getDockerComposeAppShow())}},d=u))||d);t.default=A},TbKt:function(e,t,a){"use strict";var l=a("g09b"),s=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("2qtc");var n=l(a("kLXV")),r=l(a("jehZ"));a("+L6B");var i=l(a("2/Rp"));a("sRBo");var p=l(a("kaz8"));a("y8nQ");var o,d,u,c=l(a("Vl3Y")),h=s(a("q1tI")),m=l(a("e6Ls")),f=c.default.Item,g=p.default.Group,k=(o=c.default.create(),o((u=class extends h.PureComponent{constructor(e){super(e),this.handleSubmit=(()=>{var e=this.props,t=e.form,a=e.onOk,l=t.validateFields;l((e,t)=>{e||a&&a(t)})}),this.onChangeBounced=(e=>{var t=this.props.onCheckedValues;t&&t(e)})}render(){var e=this.props,t=e.onCancel,a=e.bouncedText,l=e.appInfo,s=e.form,p=s.getFieldDecorator,o=[];l&&l.versions_info&&l.versions_info.length>0&&l.versions_info.map(e=>{o.push(e.version)});var d={labelCol:{xs:{span:24},sm:{span:12}},wrapperCol:{xs:{span:24},sm:{span:12}}};return h.default.createElement(n.default,{title:a,visible:!0,onOk:this.handleSubmit,className:m.default.TelescopicModal,onCancel:t,footer:[h.default.createElement(i.default,{onClick:t}," \u53d6\u6d88 "),h.default.createElement(i.default,{type:"primary",onClick:this.handleSubmit},"\u786e\u5b9a")]},h.default.createElement(c.default,{onSubmit:this.handleSubmit},h.default.createElement(f,(0,r.default)({},d,{label:l&&"".concat(l.app_name,"\u7248\u672c")}),p("chooseVersion",{initialValue:l&&[l.versions_info[0].version],rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u7248\u672c"}]})(h.default.createElement(g,{options:o,onChange:this.onChangeBounced})))))}},d=u))||d);t.default=k},VJxn:function(e,t,a){e.exports=a.p+"static/noComponent.63dc3b02.png"},"bV/r":function(e,t,a){"use strict";var l=a("g09b"),s=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("2qtc");var n=l(a("kLXV")),r=l(a("jehZ"));a("5NDa");var i=l(a("5rEg"));a("OaEy");var p=l(a("2fM7"));a("y8nQ");var o,d,u,c,h=l(a("Vl3Y")),m=a("MuoO"),f=s(a("q1tI")),g=l(a("e6Ls")),k=h.default.Item,v=p.default.Option,E=(o=h.default.create(),d=(0,m.connect)(),o(u=d((c=class extends f.PureComponent{constructor(e){super(e),this.handleSubmit=(()=>{var e=this.props,t=e.form,a=e.marketInfo;t.validateFields((e,t)=>{e||(a?this.upAppMarket(t):this.createAppMarket(t))})}),this.upAppMarket=(e=>{var t=this.props,a=t.dispatch,l=t.eid,s=t.onOk,n=t.marketInfo;a({type:"market/upAppMarket",payload:Object.assign({},{enterprise_id:l,marketName:n.name},e),callback:e=>{if(e&&200===e._code){var t=e.list;s&&s(t&&t.ID)}}})}),this.createAppMarket=(e=>{var t=this.props,a=t.dispatch,l=t.eid,s=t.onOk;a({type:"market/createAppMarket",payload:Object.assign({},{enterprise_id:l},e),callback:e=>{if(e&&200===e._code){var t=e.bean;s&&s(t&&t.ID)}}})}),this.state={marketType:[{key:"rainstore",name:"Rainstore"}]}}render(){var e=this.props.form.getFieldDecorator,t=this.props,a=t.onCancel,l=t.title,s=t.marketInfo,o=void 0===s?{}:s,d=t.loading,u=this.state.marketType,c={labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:14}}};return f.default.createElement(n.default,{title:l,visible:!0,className:g.default.TelescopicModal,onOk:this.handleSubmit,onCancel:a,confirmLoading:d||!1},f.default.createElement("span",{style:{textAlign:"center",display:"block",marginBottom:"16px"}},"\u5f00\u901a\u81ea\u5df1\u7684\u5e94\u7528\u5546\u5e97\uff1f",f.default.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://store.goodrain.com/marketregist"},"\u53bb\u5f00\u901a")),f.default.createElement(h.default,{onSubmit:this.handleSubmit,layout:"horizontal"},f.default.createElement(k,(0,r.default)({},c,{label:"\u6807\u8bc6"}),e("name",{initialValue:o.name||"",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u6807\u8bc6"},{pattern:/^[a-z0-9A-Z-_]+$/,message:"\u53ea\u652f\u6301\u5b57\u6bcd\u3001\u6570\u5b57\u548c-_\u7ec4\u5408"},{max:64,message:"\u6700\u5927\u957f\u5ea664\u4f4d"}]})(f.default.createElement(i.default,{placeholder:"\u8bf7\u8f93\u5165\u6807\u8bc6"})),f.default.createElement("div",{className:g.default.conformDesc},"\u76f8\u540c\u7684\u6807\u8bc6\u53ef\u4ee5\u5e2e\u52a9\u7528\u6237\u5728\u5220\u9664\u5df2\u6709\u5e02\u573a\u540e\u91cd\u65b0\u6dfb\u52a0\u56de\u6765\u3002")),f.default.createElement(k,(0,r.default)({},c,{label:"\u7c7b\u578b"}),e("type",{initialValue:o.type||"rainstore",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u5e94\u7528\u5e02\u573a\u7c7b\u578b"}]})(f.default.createElement(p.default,{placeholder:"\u8bf7\u9009\u62e9\u5e94\u7528\u5e02\u573a\u7c7b\u578b"},u.map(e=>{return f.default.createElement(v,{key:e.key},e.name)})))),f.default.createElement(k,(0,r.default)({},c,{label:"\u901a\u4fe1\u5730\u5740"}),e("url",{initialValue:o.url||"",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u901a\u4fe1\u5730\u5740"}]})(f.default.createElement(i.default,{placeholder:"\u8bf7\u8f93\u5165\u901a\u4fe1\u5730\u5740"}))),f.default.createElement(k,(0,r.default)({},c,{label:"\u5e02\u573a\u57df"}),e("domain",{initialValue:o.domain||"",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5e02\u573a\u57df"}]})(f.default.createElement(i.default,{placeholder:"\u8bf7\u8f93\u5165\u5e02\u573a\u57df"}))),f.default.createElement(k,(0,r.default)({},c,{label:"AccessKey"}),e("access_key",{initialValue:o.access_key||"",rules:[{required:!1,message:"\u8bf7\u8f93\u5165AccessKey"},{max:64,message:"\u6700\u5927\u957f\u5ea664\u4f4d"}]})(f.default.createElement(i.default,{placeholder:"\u8bf7\u8f93\u5165AccessKey"})),f.default.createElement("div",{className:g.default.conformDesc},"\u4e3a\u7a7a\u5219\u53ea\u8bfb\u6743\u9650\u3001\u8bf7\u524d\u5f80\u5e94\u7528\u5e02\u573a\u83b7\u53d6AccessKey"))))}},u=c))||u)||u),A=E;t.default=A},oBm1:function(e,t,a){"use strict";var l=a("g09b"),s=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("DjyN");var n=l(a("NUBc"));a("5Dmo");var r=l(a("3S7+"));a("Pwec");var i=l(a("CtXQ"));a("T2oS");var p=l(a("W9HT"));a("14J3");var o=l(a("BMrR"));a("sRBo");var d=l(a("kaz8"));a("/zsF");var u=l(a("PArb"));a("7Kak");var c=l(a("9yH6"));a("R9oj");var h=l(a("ECub"));a("jCWc");var m=l(a("kPKH"));a("+L6B");var f=l(a("2/Rp"));a("lUTK");var g=l(a("BvKs"));a("/xke");var k=l(a("TeRw"));a("5NDa");var v=l(a("5rEg"));a("Znn+");var E,A,b,y=l(a("ZTPi")),C=a("MuoO"),_=a("7DNP"),M=s(a("q1tI")),x=l(a("VJxn")),S=l(a("/VoG")),T=l(a("q76B")),w=l(a("bV/r")),D=l(a("qula")),L=l(a("TbKt")),O=l(a("+tCj")),I=l(a("iPMB")),P=l(a("XZXw")),N=a("34ay"),V=l(a("QDog")),B=l(a("+iC2")),R=l(a("zrlW")),q=l(a("UR3D")),z=l(a("695H")),j=y.default.TabPane,K=v.default.Search,U=(E=(0,C.connect)(e=>{var t=e.user,a=e.global,l=e.loading;return{user:t.currentUser,enterprise:a.enterprise,upAppMarketLoading:l.effects["market/upAppMarket"],createAppMarketLoading:l.effects["market/createAppMarket"]}}),E((b=class extends M.PureComponent{constructor(e){super(e),this.onChangeRadio=(e=>{this.setState({page:1,scope:e.target.value},()=>{this.getApps()})}),this.onChangeCheckbox=(e=>{this.setState({tags:e},()=>{this.getApps()})}),this.onChangeBounced=(e=>{this.setState({chooseVersion:e})}),this.onPageChangeApp=((e,t)=>{this.setState({page:e,pageSize:t},()=>{this.getApps()})}),this.onPageChangeAppMarket=((e,t)=>{var a=this.state,l=a.marketInfo,s=a.marketPag,n=Object.assign({},s,{page:e,pageSize:t});this.setState({marketPag:n},()=>{this.getMarkets(l&&l.name)})}),this.onTabChange=(e=>{if("add"===e)return this.handleOpencreateAppMarket(),null;var t=this.state.marketTab,a=[];a=t.filter(t=>{return t.ID===Number(e)});var l=a&&a.length>0,s=l&&""===a[0].access_key&&"rainbond"===a[0].domain||!1;return this.setState({marketInfo:!!l&&a[0],showCloudMarketAuth:s,activeTabKey:"".concat(e),name:"",marketList:[],marketLoading:!1,marketPag:{pageSize:10,total:0,page:1,query:""}},()=>{"local"!==e&&l&&1===a[0].status&&this.getMarkets(a[0].name)}),null}),this.getApps=(()=>{var e=this.props,t=e.dispatch,a=e.user,l=e.match.params.eid,s=this.state,n=s.page,r=s.pageSize,i=s.name,p=s.scope,o=s.tags;this.setState({localLoading:!0},()=>{t({type:"market/fetchAppModels",payload:{enterprise_id:l,user_id:a.user_id,app_name:i,scope:p,page:n,page_size:r,tags:o},callback:e=>{e&&200===e._code&&this.setState({total:e.total,componentList:e.list,localLoading:!1})}})})}),this.getTags=(()=>{var e=this.props,t=e.dispatch,a=e.match.params.eid;t({type:"market/fetchAppModelsTags",payload:{enterprise_id:a},callback:e=>{e&&200===e._code&&this.setState({tagList:e.list})}})}),this.getMarketsTab=(e=>{var t=this.props,a=t.dispatch,l=t.match.params.eid;this.setState({marketTabLoading:!0}),a({type:"market/fetchMarketsTab",payload:{enterprise_id:l},callback:t=>{t&&200===t._code&&this.setState({marketTabLoading:!1,marketTab:t.list},()=>{e&&this.onTabChange(e)})}})}),this.getMarkets=(e=>{var t=this.props,a=t.dispatch,l=t.match.params.eid,s=this.state.marketPag,n=Object.assign({},{name:e,enterprise_id:l},s);this.setState({marketLoading:!0}),a({type:"market/fetchMarkets",payload:n,callback:e=>{if(e&&200===e._code){var t=Object.assign({},this.state.marketPag,{total:e.total});this.setState({marketLoading:!1,marketList:e.list,marketPag:t})}}})}),this.load=(()=>{this.getApps(),this.getTags(),this.getMarketsTab()}),this.handleSearchLocal=(e=>{this.setState({page:1,name:e},()=>{this.getApps()})}),this.handleSearchMarket=(e=>{var t=this.state,a=t.marketPag,l=t.marketInfo,s=Object.assign({},a,{page:1,query:e});this.setState({marketPag:s},()=>{this.getMarkets(l&&l.name)})}),this.handleOpenEditorMoreTags=(()=>{this.setState({moreTags:!0,editorTags:!0})}),this.handleOpenMoreTags=(e=>{this.setState({moreTags:!0,seeTag:e})}),this.handleCloseMoreTags=(()=>{this.setState({moreTags:!1,editorTags:!1,seeTag:!1})}),this.showOfflineApp=(e=>{this.setState({appInfo:e,deleteApp:!0,bouncedText:"\u5220\u9664\u5e94\u7528\u6a21\u7248",bouncedType:"delete"})}),this.handleOpenDeleteAppMarket=(()=>{this.setState({deleteAppMarket:!0})}),this.handleCloseDeleteAppMarket=(()=>{this.setState({deleteAppMarket:!1})}),this.handleOkBounced=(e=>{var t=this.state.bouncedType;this.setState({chooseVersion:e.chooseVersion},()=>{"delete"==t?this.setState({deleteApp:!0}):this.handleCloudsUpdate(e.chooseVersion)})}),this.handleDeleteApp=(()=>{var e=this.state.appInfo,t=this.props,a=t.dispatch,l=t.match.params.eid;a({type:"global/deleteAppModel",payload:{enterprise_id:l,app_id:e.app_id},callback:e=>{e&&200===e._code&&(k.default.success({message:"\u5220\u9664\u6210\u529f"}),this.handleCancelDelete(),this.getApps())}})}),this.handleDeleteAppMarket=(()=>{var e=this.state.marketInfo;this.setState({deleteAppMarketLoading:!0});var t=this.props,a=t.dispatch,l=t.match.params.eid;a({type:"market/deleteAppMarket",payload:{enterprise_id:l,marketName:e.name},callback:e=>{e&&200===e._code&&(this.handleCloseDeleteAppMarket(),this.getMarketsTab(),this.setState({activeTabKey:"local",marketInfo:!1,deleteAppMarketLoading:!1}),k.default.success({message:"\u5220\u9664\u6210\u529f"}))}})}),this.handleCancelDelete=(()=>{this.setState({deleteApp:null,visibles:null,group_version:null,bouncedText:"",bouncedType:"",appInfo:!1})}),this.handlePageChange=(e=>{this.state.page=e,this.getApps()}),this.handleLoadAppDetail=((e,t)=>{var a=e.versions_info&&e.versions_info.length>0&&e.versions_info;a?this.setState({visibles:!0,group_version:a,appInfo:e,bouncedText:t}):this.setState({group_version:a,appInfo:e},()=>{a&&this.handleCloudsUpdate(a[0].version)})}),this.handleCloudsUpdate=(e=>{var t=this.state.appInfo,a=this.props,l=a.dispatch,s=a.match.params.eid;l({type:"global/syncMarketAppDetail",payload:{enterprise_id:s,body:{app_id:t.app_id,app_versions:e}},callback:e=>{e&&200===e._code&&(this.handleCancelDelete(),k.default.success({message:"\u66f4\u65b0\u6210\u529f"}),this.getApps())}})}),this.handleCreateAppModel=(()=>{k.default.success({message:"\u521b\u5efa\u6210\u529f"}),this.getApps(),this.handleCancelAppModel()}),this.handleCreateAppMarket=(e=>{var t=this.state.upAppMarket;k.default.success({message:t?"\u7f16\u8f91\u6210\u529f":"\u521b\u5efa\u6210\u529f"}),this.getMarketsTab(e),this.handleCancelAppMarket()}),this.handleCancelAppModel=(()=>{this.setState({createAppModel:!1,appInfo:null})}),this.handleOpenCreateAppModel=(()=>{this.setState({createAppModel:!0})}),this.handleOpenUpAppMarket=(()=>{this.setState({upAppMarket:!0})}),this.handleOpencreateAppMarket=(()=>{this.setState({createAppMarket:!0})}),this.handleCancelAppMarket=(()=>{this.setState({createAppMarket:!1,upAppMarket:!1})}),this.handleupDataAppModel=(()=>{k.default.success({message:"\u7f16\u8f91\u6210\u529f"}),this.getApps(),this.handleCancelupDataAppModel()}),this.handleOpenUpDataAppModel=(e=>{this.setState({appInfo:e,upDataAppModel:!0})}),this.handleAppModel=(e=>{var t=this.props,a=t.dispatch,l=t.match.params.eid;a(_.routerRedux.push("/enterprise/".concat(l,"/shared/app/").concat(e.app_id)))}),this.handleCancelupDataAppModel=(()=>{this.setState({appInfo:null,upDataAppModel:!1})}),this.showMarketAppDetail=(e=>{e&&e.app_detail_url?window.open(e.app_detail_url,"_blank"):this.setState({showApp:e,showMarketAppDetail:!0})}),this.hideMarketAppDetail=(()=>{this.setState({showApp:{},showMarketAppDetail:!1})});var t=this.props.user,a=B.default.isPermissions(t,"app_store");this.state={marketPag:{pageSize:10,total:0,page:1,query:""},pageSize:10,total:0,page:1,componentList:[],localLoading:!0,marketLoading:!0,marketTabLoading:!0,appStoreAdmin:a,tagList:[],tags:[],scope:"enterprise",appInfo:!1,visibles:null,bouncedText:"",bouncedType:"",group_version:null,chooseVersion:null,deleteApp:!1,deleteAppMarket:!1,deleteAppMarketLoading:!1,createAppModel:!1,upDataAppModel:!1,createAppMarket:!1,moreTags:!1,editorTags:!1,seeTag:!1,marketList:[],marketTab:[],activeTabKey:"local",marketInfo:!1,upAppMarket:!1,showCloudMarketAuth:!1,showApp:{},showMarketAppDetail:!1}}componentDidMount(){var e=this.props.user;e&&this.load()}render(){var e=this.props,t=e.match.params.eid,a=e.upAppMarketLoading,l=this.state,s=l.componentList,k=l.marketList,v=l.marketTab,E=l.localLoading,A=l.marketLoading,b=l.tagList,C=l.appInfo,B=l.visibles,U=l.bouncedText,X=l.appStoreAdmin,Z=X.isCreateApp,F=X.isEditApp,J=X.isDeleteApp,Q=X.isImportApp,G=X.isExportApp,H=X.isCreateAppStore,W=X.isEditAppStore,Y=X.isDeleteAppStore,$=l.activeTabKey,ee=l.marketInfo,te=l.marketPag,ae=b&&b.length>0&&b,le=ee&&ee.access_actions&&ee.access_actions.length>0&&ee.access_actions,se=ee&&1==ee.status,ne=V.default.fetchSvg("defaulAppImg"),re=e=>{var a=J&&M.default.createElement(g.default.Item,null,M.default.createElement("a",{onClick:()=>{this.showOfflineApp(e)}},"\u5220\u9664\u5e94\u7528\u6a21\u7248")),l=F&&M.default.createElement(g.default.Item,null,M.default.createElement("a",{onClick:()=>{this.handleOpenUpDataAppModel(e)}},"\u7f16\u8f91\u5e94\u7528\u6a21\u7248")),s=e&&e.versions_info&&e.versions_info.length>0&&M.default.createElement(g.default.Item,null,M.default.createElement(R.default,{app:e,eid:t}));return s||l||a?M.default.createElement(g.default,null,G&&s,l,a):null},ie=M.default.createElement(m.default,{span:5,style:{textAlign:"right"},className:q.default.btns},Q&&M.default.createElement(f.default,{style:{margin:"0 14px 0 10px"}},M.default.createElement(_.Link,{to:"/enterprise/".concat(t,"/shared/import")},"\u79bb\u7ebf\u5bfc\u5165")),Z&&M.default.createElement(f.default,{type:"primary",onClick:this.handleOpenCreateAppModel},"\u521b\u5efa\u5e94\u7528\u6a21\u7248")),pe=M.default.createElement("div",null,Y&&M.default.createElement(f.default,{onClick:this.handleOpenDeleteAppMarket,style:{marginRight:"22px"}},"\u5220\u9664"),W&&M.default.createElement(f.default,{type:"primary",onClick:this.handleOpenUpAppMarket},"\u7f16\u8f91")),oe=M.default.createElement("div",{className:q.default.noShared},M.default.createElement("img",{src:x.default}),M.default.createElement("p",null,"\u5f53\u524d\u65e0\u5e94\u7528\u6a21\u7248\uff0c\u8bf7\u9009\u62e9\u65b9\u5f0f\u6dfb\u52a0"),M.default.createElement("div",{className:q.default.btns},Z&&M.default.createElement(f.default,{type:"primary",onClick:this.handleOpenCreateAppModel},"\u521b\u5efa\u5e94\u7528\u6a21\u7248"),Q&&M.default.createElement(f.default,{type:"primary"},M.default.createElement(_.Link,{to:"/enterprise/".concat(t,"/shared/import")},"\u5bfc\u5165\u5e94\u7528\u6a21\u7248")))),de=M.default.createElement(h.default,{style:{marginTop:"120px"},image:"https://gw.alipayobjects.com/mdn/miniapp_social/afts/img/A*pevERLJC9v0AAAAAAAAAAABjAQAAAQ/original",imageStyle:{height:60},description:M.default.createElement("span",null,se?"\u6682\u65e0\u6570\u636e":"\u5e02\u573a\u672a\u8fde\u63a5\u3001\u6682\u65e0\u6570\u636e")},!se&&pe),ue=M.default.createElement("div",null,M.default.createElement(o.default,{style:{display:"flex",alignItems:"center",marginBottom:"20px",marginTop:"4px"}},M.default.createElement(m.default,{span:19,style:{textAlign:"left",display:"flex"}},M.default.createElement(K,{style:{width:"250px"},placeholder:"\u8bf7\u8f93\u5165\u540d\u79f0\u8fdb\u884c\u641c\u7d22",onSearch:this.handleSearchLocal}),M.default.createElement("div",{className:q.default.serBox},M.default.createElement(c.default.Group,{className:q.default.setRadioGroup,value:this.state.scope,onChange:this.onChangeRadio},M.default.createElement(c.default.Button,{value:"enterprise"},"\u4f01\u4e1a"),M.default.createElement(c.default.Button,{value:"team"},"\u56e2\u961f")),ae&&M.default.createElement(u.default,{type:"vertical"}),ae&&M.default.createElement(d.default.Group,{className:q.default.setCheckboxGroup,onChange:this.onChangeCheckbox,value:this.state.tags},ae.map((e,t)=>{var a=e.name,l=e.tag_id;return t>4?null:M.default.createElement(d.default,{key:l,value:a},a)}),M.default.createElement("a",{onClick:this.handleOpenEditorMoreTags,style:{float:"right"}},"\u66f4\u591a\u6807\u7b7e")))),ie),E?M.default.createElement("div",{className:q.default.example},M.default.createElement(p.default,null)):s&&s.length>0?s.map(e=>{var t=e.app_id,a=e.pic,l=e.describe,s=e.app_name,n=e.tags,p=e.versions_info,o=e.dev_status,d=e.install_number;return M.default.createElement(O.default,{key:t,stylePro:{marginBottom:"10px"},Cols:M.default.createElement("div",{className:q.default.h70,onClick:t=>{t.stopPropagation(),this.handleAppModel(e)}},M.default.createElement(m.default,{span:3,style:{display:"flex"}},M.default.createElement("div",{className:q.default.lt,onClick:e=>{e.stopPropagation()}},M.default.createElement("div",null,M.default.createElement(i.default,{type:"arrow-down"}),M.default.createElement("div",{title:d},V.default.nFormatter(d)))),M.default.createElement("div",{className:q.default.imgs},a?M.default.createElement("img",{src:a,alt:""}):ne)),M.default.createElement(m.default,{span:13,className:q.default.tits},M.default.createElement("div",null,M.default.createElement("p",null,M.default.createElement("a",{onClick:t=>{t.stopPropagation(),this.showMarketAppDetail(e)}},s)),M.default.createElement("p",null,M.default.createElement(r.default,{placement:"topLeft",title:l},l)))),M.default.createElement(m.default,{span:3,className:q.default.status},M.default.createElement("div",null,o&&M.default.createElement("p",{className:q.default.dev_status},o),p&&p.length>0?M.default.createElement("p",{className:q.default.dev_version},p[p.length-1].version):M.default.createElement("p",{className:q.default.dev_version},"\u65e0\u7248\u672c"))),M.default.createElement(m.default,{span:5,className:q.default.tags},n&&n.length>0&&n.map((e,t)=>{var a=e.tag_id,l=e.name;return t>2?null:M.default.createElement("div",{key:a,style:{marginRight:"5px"}},l)}),n&&n.length>3&&M.default.createElement("a",{style:{marginLeft:"5px"},onClick:e=>{e.stopPropagation();var t=n.map(e=>e.name);this.handleOpenMoreTags(t)}},"\u66f4\u591a"))),overlay:re(e)})}):oe,M.default.createElement("div",{style:{textAlign:"right"}},M.default.createElement(n.default,{showQuickJumper:!0,current:this.state.page,pageSize:this.state.pageSize,total:Number(this.state.total),onChange:this.onPageChangeApp}))),ce=M.default.createElement("div",null,se&&M.default.createElement(o.default,{style:{display:"flex",alignItems:"center",marginBottom:"20px",marginTop:"4px"}},M.default.createElement(m.default,{span:19,style:{textAlign:"left",display:"flex",alignItems:"center"}},M.default.createElement("div",null,"\u5e02\u573a\u5df2\u7ecf\u6b63\u5e38\u8fde\u63a5\uff0c\u8be5\u5e73\u53f0\u5177\u6709\xa0",le&&le.map((e,t)=>{return M.default.createElement("a",null,(0,N.fetchMarketMap)(e),t<le.length-1&&M.default.createElement(u.default,{type:"vertical",style:{background:"#1890ff"}}))}),"\xa0\u5e94\u7528\u6743\u9650"),M.default.createElement(K,{style:{width:"400px",marginLeft:"100px"},placeholder:"\u8bf7\u8f93\u5165\u540d\u79f0\u8fdb\u884c\u641c\u7d22",onSearch:this.handleSearchMarket})),M.default.createElement(m.default,{span:5,style:{textAlign:"right"},className:q.default.btns},pe)),A?M.default.createElement("div",{className:q.default.example},M.default.createElement(p.default,null)):k&&k.length>0?k.map(e=>{var t=e.app_id,a=e.logo,l=e.describe,s=e.app_name,n=e.tags,p=e.versions,o=e.dev_status,d=e.install_number;return M.default.createElement(O.default,{key:t,stylePro:{marginBottom:"10px"},Cols:M.default.createElement("div",{className:q.default.h70},M.default.createElement(m.default,{span:3,style:{display:"flex"}},M.default.createElement("div",{className:q.default.lt,onClick:e=>{e.stopPropagation()}},M.default.createElement("div",null,M.default.createElement(i.default,{type:"arrow-down"}),M.default.createElement("div",{title:d},V.default.nFormatter(d)))),M.default.createElement("div",{className:q.default.imgs},a?M.default.createElement("img",{src:a,alt:""}):ne)),M.default.createElement(m.default,{span:13,className:q.default.tits},M.default.createElement("div",null,M.default.createElement("p",null,M.default.createElement("a",{onClick:()=>{this.showMarketAppDetail(e)}},s)),M.default.createElement("p",null,M.default.createElement(r.default,{placement:"topLeft",title:l},l)))),M.default.createElement(m.default,{span:3,className:q.default.status},M.default.createElement("div",null,o&&M.default.createElement("p",{className:q.default.dev_status},o),p&&p.length>0?M.default.createElement("p",{className:q.default.dev_version},p[0].app_version):M.default.createElement("p",{className:q.default.dev_version},"\u65e0\u7248\u672c"))),M.default.createElement(m.default,{span:5,className:q.default.tags},n&&n.length>0&&n.map((e,t)=>{return t>2?null:M.default.createElement("div",{key:e,style:{marginRight:"5px"}},e)}),n&&n.length>3&&M.default.createElement("a",{style:{marginLeft:"5px"},onClick:e=>{e.stopPropagation(),this.handleOpenMoreTags(n)}},"\u66f4\u591a")))})}):de,M.default.createElement("div",{style:{textAlign:"right"}},M.default.createElement(n.default,{showQuickJumper:!0,current:te.page,pageSize:te.pageSize,total:Number(te.total),onChange:this.onPageChangeAppMarket})));return M.default.createElement(P.default,{title:"\u5e94\u7528\u5e02\u573a\u7ba1\u7406",content:"\u5e94\u7528\u6a21\u578b\u662f\u6307\u6a21\u578b\u5316\u3001\u6807\u51c6\u5316\u7684\u5e94\u7528\u5236\u54c1\u5305\uff0c\u662f\u4f01\u4e1a\u6570\u5b57\u8d44\u4ea7\u7684\u5e94\u7528\u5316\u4ea7\u7269\uff0c\u53ef\u4ee5\u901a\u8fc7\u6807\u51c6\u7684\u65b9\u5f0f\u5b89\u88c5\u5230\u4efb\u4f55Rainbond\u5e73\u53f0\u6216\u5176\u4ed6\u652f\u6301\u7684\u4e91\u539f\u751f\u5e73\u53f0"},this.state.showMarketAppDetail&&M.default.createElement(I.default,{onOk:this.hideMarketAppDetail,onCancel:this.hideMarketAppDetail,app:this.state.showApp}),this.state.moreTags&&M.default.createElement(z.default,{title:"\u67e5\u770b\u6807\u7b7e",onOk:this.handleCloseMoreTags,onChangeCheckbox:this.onChangeCheckbox,onCancel:this.handleCloseMoreTags,tagLists:ae,seeTag:this.state.seeTag,checkedValues:this.state.tags,componentList:this.state.componentList,editorTags:this.state.editorTags}),this.state.deleteApp&&M.default.createElement(T.default,{onOk:this.handleDeleteApp,desc:"\u786e\u5b9a\u8981\u5220\u9664\u6b64\u5e94\u7528\u6a21\u578b\u5417?",subDesc:"\u5220\u9664\u540e\u5176\u4ed6\u4eba\u5c06\u65e0\u6cd5\u5b89\u88c5\u6b64\u5e94\u7528\u6a21\u578b",title:"\u5220\u9664\u5e94\u7528\u6a21\u7248",onCancel:this.handleCancelDelete}),this.state.deleteAppMarket&&M.default.createElement(T.default,{onOk:this.handleDeleteAppMarket,loading:this.state.deleteAppMarketLoading,subDesc:"\u6b64\u64cd\u4f5c\u4e0d\u53ef\u6062\u590d",desc:"\u786e\u5b9a\u8981\u5220\u9664\u6b64".concat(ee.alias,"\u5417?"),title:"\u5220\u9664".concat(ee.alias),onCancel:this.handleCloseDeleteAppMarket}),this.state.createAppModel&&M.default.createElement(D.default,{title:"\u521b\u5efa\u5e94\u7528\u6a21\u7248",eid:t,onOk:this.handleCreateAppModel,onCancel:this.handleCancelAppModel}),this.state.createAppMarket&&M.default.createElement(S.default,{eid:t,title:"\u6dfb\u52a0\u5e94\u7528\u5546\u5e97",onCancel:this.handleCancelAppMarket,currStep:1}),this.state.upAppMarket&&M.default.createElement(w.default,{title:"\u7f16\u8f91\u5e94\u7528\u5546\u5e97\u8fde\u63a5\u4fe1\u606f",eid:t,loading:a,marketInfo:ee,onOk:this.handleCreateAppMarket,onCancel:this.handleCancelAppMarket}),this.state.upDataAppModel&&M.default.createElement(D.default,{title:"\u7f16\u8f91\u5e94\u7528\u6a21\u7248",eid:t,appInfo:C,onOk:this.handleupDataAppModel,onCancel:this.handleCancelupDataAppModel}),B&&M.default.createElement(L.default,{appInfo:C,bouncedText:U,onOk:this.handleOkBounced,onCancel:this.handleCancelDelete,onCheckedValues:this.onChangeBounced}),this.state.showCloudMarketAuth&&M.default.createElement(S.default,{eid:t,marketName:ee.name,title:"\u60a8\u5728\u8be5\u4e91\u5e94\u7528\u5546\u5e97\u65e0\u5b89\u88c5\u6743\u9650\uff0c\u8bf7\u767b\u5f55\u83b7\u53d6\u6388\u6743",onCancel:()=>{this.setState({showCloudMarketAuth:!1})},currStep:2}),M.default.createElement(y.default,{activeKey:$,className:q.default.setTabs,onChange:this.onTabChange},M.default.createElement(j,{tab:M.default.createElement("span",{className:q.default.verticalCen},V.default.fetchSvg("localMarket"),"\u672c\u5730\u7ec4\u4ef6\u5e93"),key:"local"},M.default.createElement("div",{style:{display:"block",position:"relative",overflow:"hidden"}},ue)),v.map(e=>{var t=e.ID,a=e.alias,l=e.name;return M.default.createElement(j,{tab:M.default.createElement("span",{className:q.default.verticalCen},V.default.fetchSvg("cloudMarket"),a||l),key:t},ce)}),H&&M.default.createElement(j,{tab:M.default.createElement(r.default,{placement:"top",title:"\u6dfb\u52a0\u5e94\u7528\u5e02\u573a"},M.default.createElement(i.default,{type:"plus",className:q.default.addSvg})),key:"add"})))}},A=b))||A);t.default=U},zrlW:function(e,t,a){"use strict";var l=a("tAuX"),s=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r,i,p=a("MuoO"),o=l(a("q1tI")),d=s(a("Qwvg")),u=(n=(0,p.connect)(e=>{var t=e.user;return{currentUser:t.currentUser}}),n((i=class extends o.PureComponent{constructor(e){super(e),this.setIsExporting=(e=>{this.setState({is_exporting:e})}),this.hideAppExport=(()=>{this.setState({showExporterApp:!1})}),this.showAppExport=(()=>{this.setState({showExporterApp:!0})}),this.state={is_exporting:!1,showExporterApp:!1}}componentDidMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}render(){var e=this.props,t=e.eid,a=e.app;return o.default.createElement(o.Fragment,null,o.default.createElement("a",{onClick:this.showAppExport,style:{marginRight:8},href:"javascript:;"},"\u5bfc\u51fa\u5e94\u7528\u6a21\u7248",this.state.is_exporting?"(\u5bfc\u51fa\u4e2d)":""),this.state.showExporterApp&&o.default.createElement(d.default,{eid:t,setIsExporting:this.setIsExporting,app:a,onOk:this.hideAppExport,onCancel:this.hideAppExport}))}},r=i))||r);t.default=u}}]);