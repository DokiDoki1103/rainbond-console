(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[63],{"7KHJ":function(e,t,a){"use strict";var r=a("g09b"),s=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("14J3");var o=r(a("BMrR"));a("jCWc");var u=r(a("kPKH"));a("fOrg");var i=r(a("+KLJ"));a("miYZ");var n,d,c,l=r(a("tsqr")),f=r(a("p0pE")),h=a("MuoO"),m=a("7DNP"),p=s(a("q1tI")),_=r(a("8+Sn")),g=r(a("mWxT")),v=r(a("w2qy")),b=r(a("CTfg")),w=g.default.OauthParameter("code"),y=g.default.OauthParameter("service_id"),k=g.default.OauthParameter("oauth_user_id"),E=(g.default.OauthParameter("oauth_type"),n=(0,h.connect)(e=>{var t=e.loading,a=e.global;return{login:{},isRegist:a.isRegist,rainbondInfo:a.rainbondInfo,submitting:t.effects["user/login"]}}),n((c=class extends p.Component{constructor(){super(...arguments),this.state={user_info:null},this.handleSubmit=(e=>{var t=this.props.dispatch;w&&y&&k&&t({type:"user/thirdLogin",payload:(0,f.default)({},e),callback:e=>{e&&200===e._code&&(_.default.set("token",e.bean.token),t({type:"user/fetchThirdBinding",payload:{service_id:y,oauth_user_id:k},callback:e=>{e&&e.status&&400===e.status?l.default.warning("\u8ba4\u8bc1\u5931\u8d25\uff0c\u8bf7\u91cd\u65b0\u8ba4\u8bc1",1,()=>{t(m.routerRedux.replace("/user/login"))}):e&&200===e._code&&l.default.success("\u8ba4\u8bc1\u6210\u529f",1,()=>{var e=window.localStorage.getItem("redirect");e&&""!=e||(e="/"),console.log("third login success, redirect to "+e),e.startsWith("/")?t(m.routerRedux.push(e)):window.location.href=e,window.localStorage.setItem("redirect","")})}}))}})})}componentDidMount(){this.props.dispatch({type:"user/fetchThirdInfo",payload:{code:w,service_id:y},callback:e=>{e&&200===e._code&&this.setState({user_info:e.bean.user_info})}})}render(){var e=this.props,t=e.rainbondInfo,a=e.isRegist,r=this.state.user_info,s=!g.default.fetchIsFirstRegist(t),n=g.default.OauthParameter("code"),d=g.default.OauthParameter("service_id"),c=null;return g.default.OauthbEnable(t)&&t.oauth_services&&t.oauth_services.value&&t.oauth_services.value.map(e=>{e.service_id==d&&(c=e)}),p.default.createElement("div",{className:v.default.main},p.default.createElement(i.default,{style:{margin:"24px 0"},message:"\u6765\u81ea".concat(c&&c.name,"\u767b\u5f55\u7684\n          ").concat(r&&r.oauth_user_name,"\n          \u60a8\u597d\uff01\u4f60\u9700\u8981\u8865\u5145\u5b8c\u6574\u5e73\u53f0\u8d26\u53f7\u4fe1\u606f"),type:"info"}),p.default.createElement(o.default,{style:{marginBottom:"24px"}},p.default.createElement(u.default,{span:10,className:v.default.boxJump,style:{background:"#CDE2FF"}},!s&&p.default.createElement(m.Link,{to:"/user/third/login?code=".concat(n,"&service_id=").concat(d,"&oauth_user_id=").concat(k)},"\u5df2\u6709\u8d26\u53f7\uff0c\u9a6c\u4e0a\u7ed1\u5b9a")),a&&p.default.createElement(u.default,{span:10,className:v.default.boxJump,offset:4},p.default.createElement(m.Link,{to:"/user/third/register?code=".concat(n,"&service_id=").concat(d,"&oauth_user_id=").concat(k)},"\u672a\u6709\u8d26\u53f7\uff0c\u521b\u5efa\u8d26\u53f7"))),p.default.createElement(b.default,{onSubmit:this.handleSubmit,type:"thirdLogin"}))}},d=c))||d);t.default=E}}]);