(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[62],{"2+YD":function(e,t,r){"use strict";var o=r("g09b"),s=r("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r("miYZ");var u,a,i=o(r("tsqr")),d=r("MuoO"),l=r("7DNP"),c=s(r("q1tI")),n=o(r("ALo4")),h=o(r("8+Sn")),p=o(r("QDog")),_=o(r("mWxT")),g=(u=(0,d.connect)(),u(a=class extends c.Component{constructor(e){super(e),this.state={resultState:"ing",title:"\u7b2c\u4e09\u65b9\u8ba4\u8bc1\u4e2d...",desc:"\u6b64\u8fc7\u7a0b\u53ef\u80fd\u6bd4\u8f83\u8017\u65f6\uff0c\u8bf7\u8010\u5fc3\u7b49\u5f85"}}componentWillMount(){var e=_.default.OauthParameter("code"),t=_.default.OauthParameter("service_id"),r=this.props.dispatch;if(e&&t&&"None"!==e&&"None"!==t&&""!==e&&""!==t){var o=h.default.get("token");if(o)return r({type:"global/hideNeedLogin"}),r({type:"user/fetchThirdLoginBinding",payload:{code:e,service_id:t},callback:e=>{e&&e.status&&400===e.status?this.setState({resultState:"error",title:"\u7b2c\u4e09\u65b9\u8ba4\u8bc1\u672a\u901a\u8fc7",desc:"\u8ba4\u8bc1\u5931\u8d25,\u8bf7\u91cd\u65b0\u8ba4\u8bc1"},()=>{r(l.routerRedux.push("/"))}):e&&200===e._code&&this.setState({resultState:"success",title:"\u7b2c\u4e09\u65b9\u8ba4\u8bc1\u901a\u8fc7",desc:""},()=>{this.handleSuccess()})},handleError:e=>{e&&500===e.status&&i.default.warning("\u7b2c\u4e09\u65b9\u8ba4\u8bc1\u5931\u8d25\uff0c\u8bf7\u91cd\u65b0\u8ba4\u8bc1",1,()=>{r(l.routerRedux.push("/user/login?disable_auto_login=true"))})}}),null;p.default.removeCookie(),r({type:"user/fetchThirdCertification",payload:{code:e,service_id:t,domain:window.location.host},callback:e=>{if(!e||400!==e._code&&401!==e._code){if(e&&200===e._code){var t=e.bean;if(t&&t.token)return h.default.set("token",t.token),this.handleSuccess(),null;t&&t.result&&(t.result.is_authenticated?r(l.routerRedux.push("/user/third/login?code=".concat(t.result.code,"&service_id=").concat(t.result.service_id,"&oauth_user_id=").concat(t.result.oauth_user_id,"&oauth_type=").concat(t.result.oauth_type))):r(l.routerRedux.push("/user/third/register?code=".concat(t.result.code,"&service_id=").concat(t.result.service_id,"&oauth_user_id=").concat(t.result.oauth_user_id,"&oauth_type=").concat(t.result.oauth_type))))}}else this.setState({resultState:"error",title:"\u7b2c\u4e09\u65b9\u8ba4\u8bc1\u672a\u901a\u8fc7",desc:e.msg_show},()=>{r(l.routerRedux.push("/user/login?disable_auto_login=true"))})},handleError:e=>{e&&500===e.status&&i.default.warning("\u7b2c\u4e09\u65b9\u8ba4\u8bc1\u5931\u8d25\uff0c\u8bf7\u91cd\u65b0\u8ba4\u8bc1",1,()=>{r(l.routerRedux.push("/user/login?disable_auto_login=true"))})}})}else p.default.removeCookie(),r(l.routerRedux.replace("/user/login?disable_auto_login=true"))}handleSuccess(){var e=this.props.dispatch,t=window.localStorage.getItem("redirect");t&&""!=t||(t="/"),window.localStorage.setItem("redirect",""),t.startsWith("/")?e(l.routerRedux.push(t)):window.location.href=t}render(){var e=this.state,t=e.resultState,r=e.title,o=e.desc;return c.default.createElement(n.default,{type:t,title:r,description:o,style:{marginTop:"20%",marginBottom:16}})}})||a);t.default=g}}]);